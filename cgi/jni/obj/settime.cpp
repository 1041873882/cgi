#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include "cgivars.h"
#include "eHttp.h"
#include "dmsg.h"

void process(char **getvars, char **postvars, int form_method)
{
 print_html_header(); 
    dmsg req;
    dxml p;

    req.request("/ui/web/settime/read", NULL);
    p.load(req.body());
    if(form_method == POST) {

        const char *hour = eGetText("set_hour");
        const char *min = eGetText("set_min");
        const char *sec = eGetText("set_second");
        const char *year = eGetText("set_year");
        const char *mon = eGetText("set_mon");
        const char *day = eGetText("set_day");
        
        //printf("sel = %s\n", eGetText("sel"));
        p.setText("/params/settime/tz", eGetText("sel")); 
        p.setText("/params/ntp/server", eGetText("server"));
        p.setInt("/params/ntp/enable", eGetInt("ntp"));
        p.setInt("/params/settime/hour_24", eGetInt("hour_24"));
        p.setInt("/params/settime/date", eGetInt("date_format"));
        
        //strcpy(pp[0], eGetText("set_hour"));
        //strcpy(pp[1], eGetText("set_min"));
        //strcpy(pp[2], eGetText("set_second"));

        int err = 0;
        int t0 = atoi(hour);
        int t1 = atoi(min);
        int t2 = atoi(sec);
        int t3 = atoi(year);
        int t4 = atoi(mon);
        int t5 = atoi(day);

        //printf("t0 = %d\n", t0);
        
        //t0 = eGetInt("set_hour");
        //t1 = eGetInt("set_min");
        //t2 = eGetInt("set_second");

        if (t0 < 0 || t0 > 23 || t1 < 0 || t1 > 59 || t2 < 0 || t2 > 59 ||
                t3 < 1970 || t3 > 2034 || t4 < 1 || t4 > 12 || t5 < 0) {
            err = 1;
        }

        /* 判断是否为闰年 */
        if (t4 == 4 || t4 == 6 || t4 == 9 || t4 == 11) {
            if (t5 > 30) 
                err = 1;
        } else if (t4 != 2) {
            if (t5 > 31)
                err = 1;
        }
        if (t3 % 400 == 0 || (t3 % 4 == 0 && t3 % 100 != 0)) {
            if (t4 == 2) {
                if (t5 > 29) 
                   err = 1;
            }
        } else {
            if (t4 == 2) {
                if (t5 > 28) 
                    err = 1;
            }
        }

        if (!err) {
            p.setText("/params/settime/hour", hour);
            p.setText("/params/settime/min", min);
            p.setText("/params/settime/sec", sec);
            p.setText("/params/settime/year", year);
            p.setText("/params/settime/mon", mon);
            p.setText("/params/settime/day", day);
        }



        int x = eGetInt("start_t");
        int y = eGetInt("end_t");

        p.setInt("/params/dst/enable", eGetInt("dst"));
        p.setInt("/params/dst/bias", eGetInt("bias"));
        p.setInt("/params/dst/start_m", eGetInt("start_m"));
        p.setInt("/params/dst/start_w", eGetInt("start_w"));
        p.setInt("/params/dst/start_d", eGetInt("start_d"));
        p.setInt("/params/dst/end_m", eGetInt("end_m"));
        p.setInt("/params/dst/end_w", eGetInt("end_w"));
        p.setInt("/params/dst/end_d", eGetInt("end_d"));

        if (x > 0 && x < 24 && y > 0 && y < 24) {
            p.setInt("/params/dst/start_t", x);
            p.setInt("/params/dst/end_t", y);
        }
        
        req.request("/ui/web/settime/write", p.data());     
    }
printf("    \n");
printf("<html>\n");
printf("\n");
printf("<head>\n");
printf("<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n");
printf("<style type=\"text/css\">\n");
printf("    .table {\n");
printf("        border-collapse: separate;\n");
printf("        border-spacing: 10px 10px\n");
printf("    }\n");
printf("    .input {\n");
printf("        text-align:center;\n");
printf("    }\n");
printf("    select {\n");
printf("        text-align: center;\n");
printf("        text-align-last: center;\n");
printf("    }\n");
printf("</style>\n");
printf("<script>\n");
printf("    function on_sync_button()\n");
printf("    {\n");
printf("        var p = new Date();\n");
printf("        var hour = String(p.getHours());\n");
printf("        var min = String(p.getMinutes());\n");
printf("        var sec = String(p.getSeconds());\n");
printf("        var year = String(p.getFullYear());\n");
printf("        var mon = String(p.getMonth()+1);\n");
printf("        var day = String(p.getDate());\n");
printf("\n");
printf("        document.getElementById(\"set_hour\").value = hour;\n");
printf("        document.getElementById(\"set_min\").value = min;\n");
printf("        document.getElementById(\"set_second\").value = sec;\n");
printf("        document.getElementById(\"set_year\").value = year;\n");
printf("        document.getElementById(\"set_mon\").value = mon;\n");
printf("        document.getElementById(\"set_day\").value = day;\n");
printf("    }\n");
printf("    function text_disabled(action) {\n");
printf("        if (action == 1) {\n");
printf("            document.getElementById(\"ntp\").checked = true;\n");
printf("        } else {\n");
printf("            document.getElementById(\"set_hour\").readOnly = false;\n");
printf("            document.getElementById(\"set_min\").readOnly = false;\n");
printf("            document.getElementById(\"set_second\").readOnly = false;\n");
printf("            document.getElementById(\"set_year\").readOnly = false;\n");
printf("            document.getElementById(\"set_mon\").readOnly = false;\n");
printf("            document.getElementById(\"set_day\").readOnly = false;\n");
printf("        }\n");
printf("        //document.getElementById(\"ntp\").checked;\n");
printf("    }\n");
printf("</script>\n");
printf("<link href=\"/css/style.css\" rel=\"stylesheet\" type=\"text/css\">\n");
printf("</head>\n");
printf("\n");
printf("\n");
printf("\n");
printf("\n");
printf("<body>\n");
printf("<form method=\"post\" action=\"settime.cgi\">\n");
printf("    <input type=\"hidden\" id=\"action\" name=\"action\" value=\"");
 ePrint(p.getText("/params/ntp/enable")); printf("\" />\n");
printf("    <table width=\"90%%\" border=\"0\" id=\"table1\" class=\"table\">\n");
printf("        <tr>\n");
printf("            <td class=\"header\"><strong>");
 ePrint(ehttp_xml.get("/dnake/time/title")); printf("</strong></td>\n");
printf("        </tr>\n");
printf("        <tr>\n");
printf("            <td><hr></td>       \n");
printf("        </tr>\n");
printf("    <table border=\"0\" id=\"table2\" class=\"table\">\n");
printf("        <tr>\n");
printf("            <td width=\"96\">");
 ePrint(ehttp_xml.get("/dnake/time/ntp")); printf("</td>\n");
printf("            <td><input type=\"checkbox\" name=\"ntp\" id=\"ntp\" value=\"1\" /></td>\n");
printf("        </tr>\n");
printf("        <tr>\n");
printf("            <td width=\"96\">");
 ePrint(ehttp_xml.get("/dnake/time/server")); printf("</td>\n");
printf("            <td>\n");
printf("                <input type=\"text\" class=\"input\" style=\"width:180px;\" name=\"server\" value=\"");
 ePrint(p.getText("/params/ntp/server")); printf("\" id=\"server\">\n");
printf("            </td>\n");
printf("        </tr>\n");
printf("        <tr>\n");
printf("            <td width=\"96\">");
 ePrint(ehttp_xml.get("/dnake/time/hour_24")); printf("</td>\n");
printf("            <td><input type=\"checkbox\" name=\"hour_24\" value=\"1\" ");
 if (p.getInt("/params/settime/hour_24", 0)) ePrint("checked"); printf(" /></td>\n");
printf("        </tr>\n");
printf("        <tr>\n");
printf("            <td width=\"96\">");
 ePrint(ehttp_xml.get("/dnake/time/tz")); printf("</td>\n");
printf("            <td>\n");
printf("                <select name=\"sel\" class=\"input\" style=\"width:180px;\">\n");
printf("                    <option value=\"+01:00\" ");
 if(strcmp(p.getText("/params/settime/tz"), "+01:00") == 0) ePrint("selected"); printf(">GMT+1:00</option>\n");
printf("                    <option value=\"+02:00\" ");
 if(strcmp(p.getText("/params/settime/tz"), "+02:00") == 0) ePrint("selected"); printf(">GMT+2:00</option>\n");
printf("                    <option value=\"+03:00\" ");
 if(strcmp(p.getText("/params/settime/tz"), "+03:00") == 0) ePrint("selected"); printf(">GMT+3:00</option>\n");
printf("                    <option value=\"+03:30\" ");
 if(strcmp(p.getText("/params/settime/tz"), "+03:30") == 0) ePrint("selected"); printf(">GMT+3:30</option>\n");
printf("                    <option value=\"+04:00\" ");
 if(strcmp(p.getText("/params/settime/tz"), "+04:00") == 0) ePrint("selected"); printf(">GMT+4:00</option>\n");
printf("                    <option value=\"+04:30\" ");
 if(strcmp(p.getText("/params/settime/tz"), "+04:30") == 0) ePrint("selected"); printf(">GMT+4:30</option>\n");
printf("                    <option value=\"+05:00\" ");
 if(strcmp(p.getText("/params/settime/tz"), "+05:00") == 0) ePrint("selected"); printf(">GMT+5:00</option>\n");
printf("                    <option value=\"+05:30\" ");
 if(strcmp(p.getText("/params/settime/tz"), "+05:30") == 0) ePrint("selected"); printf(">GMT+5:30</option>\n");
printf("                    <option value=\"+05:45\" ");
 if(strcmp(p.getText("/params/settime/tz"), "+05:45") == 0) ePrint("selected"); printf(">GMT+5:45</option>\n");
printf("                    <option value=\"+06:00\" ");
 if(strcmp(p.getText("/params/settime/tz"), "+06:00") == 0) ePrint("selected"); printf(">GMT+6:00</option>\n");
printf("                    <option value=\"+06:30\" ");
 if(strcmp(p.getText("/params/settime/tz"), "+06:30") == 0) ePrint("selected"); printf(">GMT+6:30</option>\n");
printf("                    <option value=\"+07:00\" ");
 if(strcmp(p.getText("/params/settime/tz"), "+07:00") == 0) ePrint("selected"); printf(">GMT+7:00</option>\n");
printf("                    <option value=\"+08:00\" ");
 if(strcmp(p.getText("/params/settime/tz"), "+08:00") == 0) ePrint("selected"); printf(">GMT+8:00</option>\n");
printf("                    <option value=\"+08:30\" ");
 if(strcmp(p.getText("/params/settime/tz"), "+08:30") == 0) ePrint("selected"); printf(">GMT+8:30</option>\n");
printf("                    <option value=\"+08:45\" ");
 if(strcmp(p.getText("/params/settime/tz"), "+08:45") == 0) ePrint("selected"); printf(">GMT+8:45</option>\n");
printf("                    <option value=\"+09:00\" ");
 if(strcmp(p.getText("/params/settime/tz"), "+09:00") == 0) ePrint("selected"); printf(">GMT+9:00</option>\n");
printf("                    <option value=\"+09:30\" ");
 if(strcmp(p.getText("/params/settime/tz"), "+09:30") == 0) ePrint("selected"); printf(">GMT+9:30</option>\n");
printf("                    <option value=\"+10:00\" ");
 if(strcmp(p.getText("/params/settime/tz"), "+10:00") == 0) ePrint("selected"); printf(">GMT+10:00</option>\n");
printf("                    <option value=\"+10:30\" ");
 if(strcmp(p.getText("/params/settime/tz"), "+10:30") == 0) ePrint("selected"); printf(">GMT+10:30</option>\n");
printf("                    <option value=\"+11:00\" ");
 if(strcmp(p.getText("/params/settime/tz"), "+11:00") == 0) ePrint("selected"); printf(">GMT+11:00</option>\n");
printf("                    <option value=\"+12:00\" ");
 if(strcmp(p.getText("/params/settime/tz"), "+12:00") == 0) ePrint("selected"); printf(">GMT+12:00</option>\n");
printf("                    <option value=\"+12:45\" ");
 if(strcmp(p.getText("/params/settime/tz"), "+12:45") == 0) ePrint("selected"); printf(">GMT+12:45</option>\n");
printf("                    <option value=\"+13:00\" ");
 if(strcmp(p.getText("/params/settime/tz"), "+13:00") == 0) ePrint("selected"); printf(">GMT+13:00</option>\n");
printf("                    <option value=\"+13:45\" ");
 if(strcmp(p.getText("/params/settime/tz"), "+13:45") == 0) ePrint("selected"); printf(">GMT+13:45</option>\n");
printf("                    <option value=\"+14:00\" ");
 if(strcmp(p.getText("/params/settime/tz"), "+14:00") == 0) ePrint("selected"); printf(">GMT+14:00</option>\n");
printf("                    <option value=\"+00:00\" ");
 if(strcmp(p.getText("/params/settime/tz"), "+00:00") == 0) ePrint("selected"); printf(">GMT+0:00</option>\n");
printf("                    <option value=\"-01:00\" ");
 if(strcmp(p.getText("/params/settime/tz"), "-01:00") == 0) ePrint("selected"); printf(">GMT-1:00</option>\n");
printf("                    <option value=\"-02:00\" ");
 if(strcmp(p.getText("/params/settime/tz"), "-02:00") == 0) ePrint("selected"); printf(">GMT-2:00</option>\n");
printf("                    <option value=\"-02:30\" ");
 if(strcmp(p.getText("/params/settime/tz"), "-02:30") == 0) ePrint("selected"); printf(">GMT-2:30</option>\n");
printf("                    <option value=\"-03:00\" ");
 if(strcmp(p.getText("/params/settime/tz"), "-03:00") == 0) ePrint("selected"); printf(">GMT-3:00</option>\n");
printf("                    <option value=\"-03:30\" ");
 if(strcmp(p.getText("/params/settime/tz"), "-03:30") == 0) ePrint("selected"); printf(">GMT-3:30</option>\n");
printf("                    <option value=\"-04:00\" ");
 if(strcmp(p.getText("/params/settime/tz"), "-04:00") == 0) ePrint("selected"); printf(">GMT-4:00</option>\n");
printf("                    <option value=\"-05:00\" ");
 if(strcmp(p.getText("/params/settime/tz"), "-05:00") == 0) ePrint("selected"); printf(">GMT-5:00</option>\n");
printf("                    <option value=\"-06:00\" ");
 if(strcmp(p.getText("/params/settime/tz"), "-06:00") == 0) ePrint("selected"); printf(">GMT-6:00</option>\n");
printf("                    <option value=\"-07:00\" ");
 if(strcmp(p.getText("/params/settime/tz"), "-07:00") == 0) ePrint("selected"); printf(">GMT-7:00</option>\n");
printf("                    <option value=\"-08:00\" ");
 if(strcmp(p.getText("/params/settime/tz"), "-08:00") == 0) ePrint("selected"); printf(">GMT-8:00</option>\n");
printf("                    <option value=\"-09:00\" ");
 if(strcmp(p.getText("/params/settime/tz"), "-09:00") == 0) ePrint("selected"); printf(">GMT-9:00</option>\n");
printf("                    <option value=\"-09:30\" ");
 if(strcmp(p.getText("/params/settime/tz"), "-09:30") == 0) ePrint("selected"); printf(">GMT-9:30</option>\n");
printf("                    <option value=\"-10:00\" ");
 if(strcmp(p.getText("/params/settime/tz"), "-10:00") == 0) ePrint("selected"); printf(">GMT-10:00</option>\n");
printf("                    <option value=\"-11:00\" ");
 if(strcmp(p.getText("/params/settime/tz"), "-11:00") == 0) ePrint("selected"); printf(">GMT-11:00</option>\n");
printf("                </select>\n");
printf("            </td>\n");
printf("        </tr>  \n");
printf("        <tr>\n");
printf("            <td>&nbsp;</td>\n");
printf("            <td>&nbsp;</td>\n");
printf("        </tr>           \n");
printf("        <tr>\n");
printf("            <td width=\"96\">");
 ePrint(ehttp_xml.get("/dnake/time/sync_pc")); printf("</td>\n");
printf("            <td>\n");
printf("                <input type=\"button\" value=\"");
 ePrint(ehttp_xml.get("/dnake/sync_time")); printf("\" onClick=\"on_sync_button()\" required>\n");
printf("            </td>\n");
printf("        </tr>\n");
printf("        <tr>\n");
printf("            <td width=\"96\">");
 ePrint(ehttp_xml.get("/dnake/time/hour")); printf("</td>\n");
printf("            <td>\n");
printf("                <input  type=\"text\" readOnly  class=\"input\" style=\"width:50;\" name=\"set_hour\" value=\"");
 ePrint(p.getText("/params/settime/hour")); printf("\" id=\"set_hour\">  :\n");
printf("                <input  type=\"text\" readOnly class=\"input\" style=\"width:50;\" name=\"set_min\" value=\"");
 ePrint(p.getText("/params/settime/min")); printf("\" id=\"set_min\">  :\n");
printf("                <input  type=\"text\" readOnly class=\"input\" style=\"width:50;\" name=\"set_second\" value=\"");
 ePrint(p.getText("/params/settime/sec")); printf("\" id=\"set_second\">\n");
printf("            </td>\n");
printf("        </tr>\n");
printf("        <tr>\n");
printf("            <td width=\"96\">");
 ePrint(ehttp_xml.get("/dnake/time/date_format")); printf("</td>\n");
printf("            <td>\n");
printf("                <select name=\"date_format\" style=\"width:180px;\">\n");
printf("                    <option value=\"0\" ");
 if(p.getInt("/params/settime/date", 0) == 0) ePrint("selected"); printf(">DD/MM/YYYY</option>\n");
printf("                    <option value=\"1\" ");
 if(p.getInt("/params/settime/date", 0) == 1) ePrint("selected"); printf(">MM/DD/YYYY</option>\n");
printf("                    <option value=\"2\" ");
 if(p.getInt("/params/settime/date", 0) == 2) ePrint("selected"); printf(">YYYY/MM/DD</option>\n");
printf("                </select>   \n");
printf("            </td>\n");
printf("        </tr>\n");
printf("        <tr>\n");
printf("            <td width=\"96\">");
 ePrint(ehttp_xml.get("/dnake/time/date")); printf("</td>\n");
printf("            <td>\n");
printf("                <input type=\"text\" readOnly class=\"input\" style=\"width:50;\" name=\"set_day\" value=\"");
 ePrint(p.getText("/params/settime/day")); printf("\" id=\"set_day\"> /\n");
printf("                <input type=\"text\" readOnly class=\"input\" style=\"width:50;\" name=\"set_mon\" value=\"");
 ePrint(p.getText("/params/settime/mon")); printf("\" id=\"set_mon\"> /\n");
printf("                <input type=\"text\" readOnly class=\"input\" style=\"width:50;\" name=\"set_year\" value=\"");
 ePrint(p.getText("/params/settime/year")); printf("\" id=\"set_year\">\n");
printf("            </td>\n");
printf("        </tr>\n");
printf("        <tr>\n");
printf("            <td>&nbsp;</td>\n");
printf("            <td>&nbsp;</td>\n");
printf("        </tr>   \n");
printf("        <tr>\n");
printf("            <td>");
 ePrint(ehttp_xml.get("/dnake/dst/enable")); printf("</td>\n");
printf("            <td><input type=\"checkbox\" name=\"dst\" value=\"1\" ");
 if (p.getInt("/params/dst/enable", 0)) ePrint("checked"); printf("/></td>\n");
printf("        </tr>\n");
printf("        <tr>\n");
printf("            <td width=\"96\">");
 ePrint(ehttp_xml.get("/dnake/dst/start")); printf("</td>\n");
printf("            <td>\n");
printf("                <select name=\"start_m\" style=\"width:80px;\">\n");
printf("                    <option value=\"1\" ");
 if(p.getInt("/params/dst/start_m", 0) == 1) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/mon_1")); printf("</option>\n");
printf("                    <option value=\"2\" ");
 if(p.getInt("/params/dst/start_m", 0) == 2) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/mon_2")); printf("</option>\n");
printf("                    <option value=\"3\" ");
 if(p.getInt("/params/dst/start_m", 0) == 3) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/mon_3")); printf("</option>\n");
printf("                    <option value=\"4\" ");
 if(p.getInt("/params/dst/start_m", 0) == 4) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/mon_4")); printf("</option>\n");
printf("                    <option value=\"5\" ");
 if(p.getInt("/params/dst/start_m", 0) == 5) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/mon_5")); printf("</option>\n");
printf("                    <option value=\"6\" ");
 if(p.getInt("/params/dst/start_m", 0) == 6) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/mon_6")); printf("</option>\n");
printf("                    <option value=\"7\" ");
 if(p.getInt("/params/dst/start_m", 0) == 7) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/mon_7")); printf("</option>\n");
printf("                    <option value=\"8\" ");
 if(p.getInt("/params/dst/start_m", 0) == 8) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/mon_8")); printf("</option>\n");
printf("                    <option value=\"9\" ");
 if(p.getInt("/params/dst/start_m", 0) == 9) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/mon_9")); printf("</option>\n");
printf("                    <option value=\"10\" ");
 if(p.getInt("/params/dst/start_m", 0) == 10) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/mon_10")); printf("</option>\n");
printf("                    <option value=\"11\" ");
 if(p.getInt("/params/dst/start_m", 0) == 11) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/mon_11")); printf("</option>\n");
printf("                    <option value=\"12\" ");
 if(p.getInt("/params/dst/start_m", 0) == 12) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/mon_12")); printf("</option>\n");
printf("                </select>\n");
printf("                <select name=\"start_w\" style=\"width:80px;\">\n");
printf("                    <option value=\"1\" ");
 if(p.getInt("/params/dst/start_w", 0) == 1) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/week_1")); printf("</option>\n");
printf("                    <option value=\"2\" ");
 if(p.getInt("/params/dst/start_w", 0) == 2) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/week_2")); printf("</option>\n");
printf("                    <option value=\"3\" ");
 if(p.getInt("/params/dst/start_w", 0) == 3) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/week_3")); printf("</option>\n");
printf("                    <option value=\"4\" ");
 if(p.getInt("/params/dst/start_w", 0) == 4) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/week_4")); printf("</option>\n");
printf("                    <option value=\"5\" ");
 if(p.getInt("/params/dst/start_w", 0) == 5) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/week_5")); printf("</option>\n");
printf("                </select>\n");
printf("                <select name=\"start_d\" style=\"width:80px;\">\n");
printf("                    <option value=\"0\" ");
 if(p.getInt("/params/dst/start_d", 0) == 0) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/date_1")); printf("</option>\n");
printf("                    <option value=\"1\" ");
 if(p.getInt("/params/dst/start_d", 0) == 1) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/date_2")); printf("</option>\n");
printf("                    <option value=\"2\" ");
 if(p.getInt("/params/dst/start_d", 0) == 2) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/date_3")); printf("</option>\n");
printf("                    <option value=\"3\" ");
 if(p.getInt("/params/dst/start_d", 0) == 3) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/date_4")); printf("</option>\n");
printf("                    <option value=\"4\" ");
 if(p.getInt("/params/dst/start_d", 0) == 4) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/date_5")); printf("</option>\n");
printf("                    <option value=\"5\" ");
 if(p.getInt("/params/dst/start_d", 0) == 5) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/date_6")); printf("</option>\n");
printf("                    <option value=\"6\" ");
 if(p.getInt("/params/dst/start_d", 0) == 6) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/date_7")); printf("</option>\n");
printf("                </select>\n");
printf("                <select name=\"start_t\" style=\"width:80px;\">\n");
printf("                    <option value=\"0\" ");
 if(p.getInt("/params/dst/start_t", 0) == 0) ePrint("selected"); printf(">00:00</option>\n");
printf("                    <option value=\"1\" ");
 if(p.getInt("/params/dst/start_t", 0) == 1) ePrint("selected"); printf(">01:00</option>\n");
printf("                    <option value=\"2\" ");
 if(p.getInt("/params/dst/start_t", 0) == 2) ePrint("selected"); printf(">02:00</option>\n");
printf("                    <option value=\"3\" ");
 if(p.getInt("/params/dst/start_t", 0) == 3) ePrint("selected"); printf(">03:00</option>\n");
printf("                    <option value=\"4\" ");
 if(p.getInt("/params/dst/start_t", 0) == 4) ePrint("selected"); printf(">04:00</option>\n");
printf("                    <option value=\"5\" ");
 if(p.getInt("/params/dst/start_t", 0) == 5) ePrint("selected"); printf(">05:00</option>\n");
printf("                    <option value=\"6\" ");
 if(p.getInt("/params/dst/start_t", 0) == 6) ePrint("selected"); printf(">06:00</option>\n");
printf("                    <option value=\"7\" ");
 if(p.getInt("/params/dst/start_t", 0) == 7) ePrint("selected"); printf(">07:00</option>\n");
printf("                    <option value=\"8\" ");
 if(p.getInt("/params/dst/start_t", 0) == 8) ePrint("selected"); printf(">08:00</option>\n");
printf("                    <option value=\"9\" ");
 if(p.getInt("/params/dst/start_t", 0) == 9) ePrint("selected"); printf(">09:00</option>\n");
printf("                    <option value=\"10\" ");
 if(p.getInt("/params/dst/start_t", 0) == 10) ePrint("selected"); printf(">10:00</option>\n");
printf("                    <option value=\"11\" ");
 if(p.getInt("/params/dst/start_t", 0) == 11) ePrint("selected"); printf(">11:00</option>\n");
printf("                    <option value=\"12\" ");
 if(p.getInt("/params/dst/start_t", 0) == 12) ePrint("selected"); printf(">12:00</option>\n");
printf("                </select> h\n");
printf("            </td>\n");
printf("        </tr>\n");
printf("        <tr>\n");
printf("            <td width=\"96\">");
 ePrint(ehttp_xml.get("/dnake/dst/end")); printf("</td>\n");
printf("            <td>\n");
printf("                <select name=\"end_m\" style=\"width:80px;\">\n");
printf("                    <option value=\"1\" ");
 if(p.getInt("/params/dst/end_m", 0) == 1) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/mon_1")); printf("</option>\n");
printf("                    <option value=\"2\" ");
 if(p.getInt("/params/dst/end_m", 0) == 2) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/mon_2")); printf("</option>\n");
printf("                    <option value=\"3\" ");
 if(p.getInt("/params/dst/end_m", 0) == 3) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/mon_3")); printf("</option>\n");
printf("                    <option value=\"4\" ");
 if(p.getInt("/params/dst/end_m", 0) == 4) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/mon_4")); printf("</option>\n");
printf("                    <option value=\"5\" ");
 if(p.getInt("/params/dst/end_m", 0) == 5) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/mon_5")); printf("</option>\n");
printf("                    <option value=\"6\" ");
 if(p.getInt("/params/dst/end_m", 0) == 6) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/mon_6")); printf("</option>\n");
printf("                    <option value=\"7\" ");
 if(p.getInt("/params/dst/end_m", 0) == 7) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/mon_7")); printf("</option>\n");
printf("                    <option value=\"8\" ");
 if(p.getInt("/params/dst/end_m", 0) == 8) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/mon_8")); printf("</option>\n");
printf("                    <option value=\"9\" ");
 if(p.getInt("/params/dst/end_m", 0) == 9) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/mon_9")); printf("</option>\n");
printf("                    <option value=\"10\" ");
 if(p.getInt("/params/dst/end_m", 0) == 10) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/mon_10")); printf("</option>\n");
printf("                    <option value=\"11\" ");
 if(p.getInt("/params/dst/end_m", 0) == 11) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/mon_11")); printf("</option>\n");
printf("                    <option value=\"12\" ");
 if(p.getInt("/params/dst/end_m", 0) == 12) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/mon_12")); printf("</option>\n");
printf("                </select>\n");
printf("                <select name=\"end_w\" style=\"width:80px;\">\n");
printf("                    <option value=\"1\" ");
 if(p.getInt("/params/dst/end_w", 0) == 1) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/week_1")); printf("</option>\n");
printf("                    <option value=\"2\" ");
 if(p.getInt("/params/dst/end_w", 0) == 2) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/week_2")); printf("</option>\n");
printf("                    <option value=\"3\" ");
 if(p.getInt("/params/dst/end_w", 0) == 3) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/week_3")); printf("</option>\n");
printf("                    <option value=\"4\" ");
 if(p.getInt("/params/dst/end_w", 0) == 4) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/week_4")); printf("</option>\n");
printf("                    <option value=\"5\" ");
 if(p.getInt("/params/dst/end_w", 0) == 5) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/week_5")); printf("</option>\n");
printf("                </select>\n");
printf("                <select name=\"end_d\" style=\"width:80px;\">\n");
printf("                    <option value=\"0\" ");
 if(p.getInt("/params/dst/end_d", 0) == 0) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/date_1")); printf("</option>\n");
printf("                    <option value=\"1\" ");
 if(p.getInt("/params/dst/end_d", 0) == 1) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/date_2")); printf("</option>\n");
printf("                    <option value=\"2\" ");
 if(p.getInt("/params/dst/end_d", 0) == 2) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/date_3")); printf("</option>\n");
printf("                    <option value=\"3\" ");
 if(p.getInt("/params/dst/end_d", 0) == 3) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/date_4")); printf("</option>\n");
printf("                    <option value=\"4\" ");
 if(p.getInt("/params/dst/end_d", 0) == 4) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/date_5")); printf("</option>\n");
printf("                    <option value=\"5\" ");
 if(p.getInt("/params/dst/end_d", 0) == 5) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/date_6")); printf("</option>\n");
printf("                    <option value=\"6\" ");
 if(p.getInt("/params/dst/end_d", 0) == 6) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/date_7")); printf("</option>\n");
printf("                </select>\n");
printf("                <select name=\"end_t\" style=\"width:80px;\">\n");
printf("                    <option value=\"0\" ");
 if(p.getInt("/params/dst/end_t", 0) == 0) ePrint("selected"); printf(">00:00</option>\n");
printf("                    <option value=\"1\" ");
 if(p.getInt("/params/dst/end_t", 0) == 1) ePrint("selected"); printf(">01:00</option>\n");
printf("                    <option value=\"2\" ");
 if(p.getInt("/params/dst/end_t", 0) == 2) ePrint("selected"); printf(">02:00</option>\n");
printf("                    <option value=\"3\" ");
 if(p.getInt("/params/dst/end_t", 0) == 3) ePrint("selected"); printf(">03:00</option>\n");
printf("                    <option value=\"4\" ");
 if(p.getInt("/params/dst/end_t", 0) == 4) ePrint("selected"); printf(">04:00</option>\n");
printf("                    <option value=\"5\" ");
 if(p.getInt("/params/dst/end_t", 0) == 5) ePrint("selected"); printf(">05:00</option>\n");
printf("                    <option value=\"6\" ");
 if(p.getInt("/params/dst/end_t", 0) == 6) ePrint("selected"); printf(">06:00</option>\n");
printf("                    <option value=\"7\" ");
 if(p.getInt("/params/dst/end_t", 0) == 7) ePrint("selected"); printf(">07:00</option>\n");
printf("                    <option value=\"8\" ");
 if(p.getInt("/params/dst/end_t", 0) == 8) ePrint("selected"); printf(">08:00</option>\n");
printf("                    <option value=\"9\" ");
 if(p.getInt("/params/dst/end_t", 0) == 9) ePrint("selected"); printf(">09:00</option>\n");
printf("                    <option value=\"10\" ");
 if(p.getInt("/params/dst/end_t", 0) == 10) ePrint("selected"); printf(">10:00</option>\n");
printf("                    <option value=\"11\" ");
 if(p.getInt("/params/dst/end_t", 0) == 11) ePrint("selected"); printf(">11:00</option>\n");
printf("                    <option value=\"12\" ");
 if(p.getInt("/params/dst/end_t", 0) == 12) ePrint("selected"); printf(">12:00</option>\n");
printf("                </select> h\n");
printf("            </td>\n");
printf("        </tr>\n");
printf("        <tr>\n");
printf("            <td width=\"96\">");
 ePrint(ehttp_xml.get("/dnake/dst/bias")); printf("</td>\n");
printf("            <td>\n");
printf("                <select name=\"bias\" style=\"width:80px;\">\n");
printf("                    <option value=\"30\" ");
 if(strcmp(p.getText("/params/dst/bias"), "0") == 30) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/bias_1")); printf("</option>\n");
printf("                    <option value=\"60\" ");
 if(strcmp(p.getText("/params/dst/bias"), "0") == 60) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/bias_2")); printf("</option>\n");
printf("                    <option value=\"90\" ");
 if(strcmp(p.getText("/params/dst/bias"), "0") == 90) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/bias_3")); printf("</option>\n");
printf("                    <option value=\"120\" ");
 if(strcmp(p.getText("/params/dst/bias"), "0") == 120) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/bias_4")); printf("</option>\n");
printf("                    <option value=\"150\" ");
 if(strcmp(p.getText("/params/dst/bias"), "0") == 150) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/bias_5")); printf("</option>\n");
printf("                    <option value=\"180\" ");
 if(strcmp(p.getText("/params/dst/bias"), "0") == 180) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/bias_6")); printf("</option>\n");
printf("                    <option value=\"210\" ");
 if(strcmp(p.getText("/params/dst/bias"), "0") == 210) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/bias_7")); printf("</option>\n");
printf("                    <option value=\"240\" ");
 if(strcmp(p.getText("/params/dst/bias"), "0") == 240) ePrint("selected"); printf(">");
 ePrint(ehttp_xml.get("/dnake/dst/bias_8")); printf("</option>\n");
printf("                </select>                        \n");
printf("            </td>\n");
printf("        </tr>\n");
printf("        <tr>\n");
printf("            <td>&nbsp;</td>\n");
printf("        </tr>   \n");
printf("    </table>\n");
printf("    <table width=\"90%%\" border=\"0\" id=\"table3\" class=\"table\">\n");
printf("        <tr>\n");
printf("            <td><hr></td>\n");
printf("        </tr>\n");
printf("        <tr>\n");
printf("            <td>\n");
printf("            <input type=\"submit\" value=\"");
 ePrint(ehttp_xml.get("/dnake/submit")); printf("\"></td>\n");
printf("        </tr>\n");
printf("    </table>\n");
printf("    <script type=\"text/javascript\">\n");
printf("        var x = document.getElementById(\'action\').value;\n");
printf("\n");
printf("        window.onload = function() {\n");
printf("            text_disabled(x);\n");
printf("        };\n");
printf("    </script>\n");
printf("</form>\n");
printf("\n");
printf("</body>\n");
printf("</html>\n");
printf("    ");
}

